{"pageProps":{"source":{"compiledSource":"var m=Object.defineProperty,l=Object.defineProperties;var u=Object.getOwnPropertyDescriptors;var o=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable;var i=(a,n,t)=>n in a?m(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,e=(a,n)=>{for(var t in n||(n={}))p.call(n,t)&&i(a,t,n[t]);if(o)for(var t of o(n))c.call(n,t)&&i(a,t,n[t]);return a},r=(a,n)=>l(a,u(n));var d=(a,n)=>{var t={};for(var s in a)p.call(a,s)&&n.indexOf(s)<0&&(t[s]=a[s]);if(a!=null&&o)for(var s of o(a))n.indexOf(s)<0&&c.call(a,s)&&(t[s]=a[s]);return t};const makeShortcode=a=>function(t){return console.warn(\"Component \"+a+\" was not imported, exported, or provided by MDXProvider as global scope\"),mdx(\"div\",e({},t))},Image=makeShortcode(\"Image\"),layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var s=t,{components:a}=s,n=d(s,[\"components\"]);return mdx(MDXLayout,r(e(e({},layoutProps),n),{components:a,mdxType:\"MDXLayout\"}),mdx(Image,{alt:\"Packages\",src:\"/images/spm/packages.jpg\",width:1440,height:1080,priority:!0,mdxType:\"Image\"}),mdx(\"h2\",e({},{id:\"key-points\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#key-points\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Key points\"),mdx(\"p\",null,\"I've moved a large project (ca. 300K SLOC, 16 external dependencies) to Swift Package Manager (SPM, SwiftPM) and would like to share my learnings with others who may want to do the same.\"),mdx(\"p\",null,\"I want to start by sharing some key points with you, and then go further in-depth by the end of the article.\"),mdx(\"p\",null,\"So, what happened when I moved a large project from Cocoapods to Swift Package Manager?\"),mdx(\"h3\",e({},{id:\"what-stayed-the-same\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#what-stayed-the-same\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"What stayed the same?\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"Compilation time: I haven't noticed any measurable difference in compilation time between Cocoapods and SPM\"),mdx(\"li\",{parentName:\"ul\"},\"App size stays the same, but SPM might be optimizing it in the future\"),mdx(\"li\",{parentName:\"ul\"},\"Startup time: a bit faster, since it's using the static frameworks\")),mdx(\"h3\",e({},{id:\"what-i-find-good\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#what-i-find-good\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"What I find good\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"Swift as a first-class citizen: packages are defined in Swift (Package.swift manifest)\"),mdx(\"li\",{parentName:\"ul\"},\"Local packages work really well. It is possible to add and remove files on the fly, Xcode can figure out the updates. As well as that, Xcode understands the changes that are happening and recalculates the dependencies if required.\"),mdx(\"li\",{parentName:\"ul\"},\"No need for \",mdx(\"inlineCode\",{parentName:\"li\"},\"xcworkspace\"),\" anymore (unless you have multiple projects)\"),mdx(\"li\",{parentName:\"ul\"},\"Integration in Xcode: to change or add the dependency, select 'project'. In the project on the right, select the project -> 'Package Dependencies'\")),mdx(Image,{alt:\"SPM Xcode Integration\",src:\"/images/spm/xcode.png\",width:2122,height:602,priority:!0,mdxType:\"Image\"}),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"It is possible to use an automatically created Bundle.module reference when looking for the bundle resources inside of a module\")),mdx(\"h3\",e({},{id:\"what-did-i-have-to-come-to-terms-with\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#what-did-i-have-to-come-to-terms-with\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"What did I have to come to terms with?\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"Frequent issues \",mdx(\"inlineCode\",{parentName:\"li\"},\"Missing package product for ...\")),mdx(\"li\",{parentName:\"ul\"},\"Package resolution takes a lot of time\"),mdx(\"li\",{parentName:\"ul\"},\"It is necessary to import Foundation and UIKit when they are used in your source files\")),mdx(\"h3\",e({},{id:\"what-could-be-improved\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#what-could-be-improved\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"What could be improved?\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"SPM is doing full checkouts of dependencies repositories. This is necessary, since SPM needs to know the version history of the repository. This is not an issue, if you would be using \",mdx(\"a\",e({parentName:\"li\"},{href:\"https://swiftpackageregistry.com\"}),\"Swift Package Registry\")),mdx(\"li\",{parentName:\"ul\"},\"Dependencies are defined inside of the \",mdx(\"inlineCode\",{parentName:\"li\"},\"project.pbxproj\")),mdx(\"li\",{parentName:\"ul\"},\"A lot of warnings from the frameworks that are not possible to suppress\")),mdx(\"h3\",e({},{id:\"was-it-worth-it\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#was-it-worth-it\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Was it worth it?\"),mdx(\"p\",null,\"Personally, I think it was worth it. SPM allows you to create a better modular project structure. Adding new packages is a fast process, and the package format is intuitive for engineers.\"),mdx(\"h2\",e({},{id:\"spm-cheat-sheet\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#spm-cheat-sheet\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"SPM cheat sheet\"),mdx(\"p\",null,\"I have summarized the practical points that I have learned in a short cheat sheet.\"),mdx(\"h3\",e({},{id:\"general-information\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#general-information\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"General information\"),mdx(\"p\",null,\"Dependencies are defined in the project or workspace file -- this is your old \",mdx(\"inlineCode\",{parentName:\"p\"},\"Podfile\"),\". Pinned versions are saved in \",mdx(\"inlineCode\",{parentName:\"p\"},\"Project.xcodeproj|Workspace.xcworkspace/xcshareddata/swiftpm/Package.resolved\"),\". This is your \",mdx(\"inlineCode\",{parentName:\"p\"},\"Podfile.lock\")),mdx(\"h4\",e({},{id:\"xcode-error-missing-build-product-for-xxx\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#xcode-error-missing-build-product-for-xxx\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Xcode error: Missing build product for \",mdx(\"inlineCode\",{parentName:\"h4\"},\"xxx\")),mdx(\"p\",null,\"Try closing Xcode, then executing in the project folder in the Terminal: \",mdx(\"inlineCode\",{parentName:\"p\"},\"xcodebuild -resolvePackageDependencies -project <Project>.xcodeproj -scheme <Scheme>\"),\", or \",mdx(\"inlineCode\",{parentName:\"p\"},\"xcodebuild -resolvePackageDependencies -workspace <Workspace>.xcworkspace -scheme <Scheme>\"),\" if you are using a workspace.\"),mdx(\"h4\",e({},{id:\"xcode-server-ssh-fingerprint-failed-to-verify\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#xcode-server-ssh-fingerprint-failed-to-verify\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Xcode: \",mdx(\"inlineCode\",{parentName:\"h4\"},\"Server SSH Fingerprint Failed to Verify\")),mdx(\"p\",null,\"Double-click the error message in Xcode and confirm the GitHub's fingerprint.\"),mdx(\"h4\",e({},{id:\"spm-is-failing-to-fetch-private-packages\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#spm-is-failing-to-fetch-private-packages\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"SPM is failing to fetch private packages\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"Sign in to GitHub in Xcode -> Preferences -> Accounts\"),mdx(\"li\",{parentName:\"ul\"},\"Check if you have a single and correct SSH key installed on your system\"),mdx(\"li\",{parentName:\"ul\"},\"Check if your SSH token is authorized with the SSO on GitHub (if your company is using SSO)\"),mdx(\"li\",{parentName:\"ul\"},\"Check if Xcode is using the default SSH configuration (You can execute \",mdx(\"inlineCode\",{parentName:\"li\"},\"defaults write com.apple.dt.Xcode IDEPackageSupportUseBuiltinSCM YES\"),\" to change this)\"),mdx(\"li\",{parentName:\"ul\"},\"Ensure ssh agent trust GitHub host (execute \",mdx(\"inlineCode\",{parentName:\"li\"},\"ssh-keyscan github.com >> ~/.ssh/known_hosts\"),\")\")),mdx(\"h3\",e({},{id:\"general-troubleshooting\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#general-troubleshooting\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"General Troubleshooting\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"Update Xcode to the latest release version\"),mdx(\"li\",{parentName:\"ul\"},\"Try File -> Packages -> Reset Package Cache\"),mdx(\"li\",{parentName:\"ul\"},\"You can try wiping the caches directory with \",mdx(\"inlineCode\",{parentName:\"li\"},\"rm -rf ~/Library/Caches/org.swift.swiftpm/\"))),mdx(\"h2\",e({},{id:\"an-in-depth-view\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#an-in-depth-view\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"An in-depth view\"),mdx(\"p\",null,\"Once the basics are out of the way, we can take a more in-depth look at the SPM and migration.\"),mdx(\"h3\",e({},{id:\"why-was-spm-introduced\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#why-was-spm-introduced\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Why was SPM introduced?\"),mdx(\"p\",null,\"SPM was introduced to fill the gap in the Swift ecosystem. Swift is intended as a general-purpose programming language, and the fact that there was no package manager on Linux meant that there was a need for SPM to be introduced.\"),mdx(\"p\",null,\"On Mac, the most prominent SPM predecessors are Cocoapods and Carthage. I recall working on iOS projects before Cocoapods, and it was a total nightmare. However, Cocoapods are great, as they modify the project file and adjust build settings. Essentially, Cocoapods are pulling the dependency sources, and configuring a separate Xcode project to build those sources in a way that a product of this build can be used in the main project. Following that, those two projects are connected with a Workspace, so Xcode can understand where the dependency library should be coming from.\"),mdx(\"p\",null,\"Carthage works in a very different way, building dependencies to frameworks so that those binary frameworks can be used by Xcode in the linking process.\"),mdx(\"p\",null,\"SPM is integrated in a much better way with Xcode and other build tools (as you might expect since it's an Apple product). It is pulling the dependency sources and creating an invisible project, similar to what Cocoapods would do.\"),mdx(\"h3\",e({},{id:\"how-to-approach-migration-to-spm\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#how-to-approach-migration-to-spm\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"How to approach migration to SPM\"),mdx(\"p\",null,\"I went all-in with the migration. Our project involved using Cocoapods to pull in the dependencies, but we also used local development pods to define logical modules of the applications. Some local pods were also dependent on the third-party libraries fetched by Cocoapods. This made step-by-step migration infeasible.\"),mdx(\"h4\",e({},{id:\"step-1-review-current-dependencies\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#step-1-review-current-dependencies\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Step 1: Review current dependencies\"),mdx(\"p\",null,\"In order to do this, I followed the following steps:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"List all external and internal dependencies\"),mdx(\"li\",{parentName:\"ul\"},\"Find out which versions of those dependencies are providing SPM support.\",mdx(\"ul\",{parentName:\"li\"},mdx(\"li\",{parentName:\"ul\"},\"If a library version already used supports SPM, all is well.\"),mdx(\"li\",{parentName:\"ul\"},\"If a library needs to be updated, the release notes of the versions we need to go over have to be checked. This can be done as a separate task, i.e. you can update to the required version with your existing package manager and allow it to be tested for compatibility with your app.\"),mdx(\"li\",{parentName:\"ul\"},\"If a library does not support SPM at all, fork it and introduce SPM to it. Then, when you are confident it is working, create a pull request from your fork to the upstream repo. Let other engineers enjoy the SPM support you\\u2019ve developed!\")))),mdx(\"p\",null,\"By the end of this process, it is important to have a list of dependencies and versions you would like to use.\"),mdx(\"h4\",e({},{id:\"step-2-remove-cocoapods-this-can-also-be-done-later\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#step-2-remove-cocoapods-this-can-also-be-done-later\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Step 2: Remove Cocoapods (this can also be done later)\"),mdx(\"p\",null,\"Cocoapods are usually deeply integrated in the project through the xcconfigs and build steps. If you would like to have a clean slate, it is necessary to remove cocoapods before you start integrating SPM packages. This can be easily achieved via \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://guides.cocoapods.org/terminal/commands.html#pod_deintegrate\"}),\"pod deintegrate\"),\".\"),mdx(\"pre\",e({},{className:\"language-bash\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-bash\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"sudo\"),\" gem \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"install\"),` cocoapods-deintegrate cocoapods-clean\npod deintegrate\npod cache clean --all\n`)),mdx(\"p\",null,\"You can also remove Podfile, Podfile.resolved and the workspace if you are not using them for anything other than Cocoapods.\"),mdx(\"p\",null,\"If you would like to go step by step, you can always remove one dependency and add it via SPM.\"),mdx(\"h4\",e({},{id:\"step-3-in-xcode-add-the-dependencies-from-step-1\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#step-3-in-xcode-add-the-dependencies-from-step-1\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Step 3: In Xcode, add the dependencies from step 1\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"In Xcode, select File -> Add Packages... menu item\"),mdx(\"li\",{parentName:\"ul\"},\"Use the top right search field to enter the git repo path for your dependency\"),mdx(\"li\",{parentName:\"ul\"},\"Let Xcode find the repository\"),mdx(\"li\",{parentName:\"ul\"},\"Select dependency rule. I recommend using exact versions to make sure your build is reproducible\"),mdx(\"li\",{parentName:\"ul\"},'Click on \"Add Package\" and let Xcode do its magic')),mdx(\"h4\",e({},{id:\"step-4-migrating-the-local-and-in-house-packages-if-any\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#step-4-migrating-the-local-and-in-house-packages-if-any\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Step 4: Migrating the local and in-house packages (if any)\"),mdx(\"p\",null,\"Moving from Cocoapods \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://guides.cocoapods.org/syntax/podspec.html\"}),\"podspec manifest\"),\" to an SPM \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://developer.apple.com/documentation/xcode/creating-a-standalone-swift-package-with-xcode\"}),\"Package.swift\"),\" is a breeze. I  I find it quite self-explanatory. Take a look at the migration example I've taken from an internal package:\"),mdx(\"h5\",e({},{id:\"cocoapods-podspec\"}),mdx(\"a\",e({parentName:\"h5\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#cocoapods-podspec\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Cocoapods podspec\"),mdx(\"pre\",e({},{className:\"language-ruby\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-ruby\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token constant\"}),\"Pod\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token constant\"}),\"Spec\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"new\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"do\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"|\"),\"s\",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"|\"),`\n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"name         \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"MyChatModule\"'),`\n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"version      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"1.0.0\"'),`\n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"summary      \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Module for MyChatModule\"'),`\n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"description  \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"\"'),`\n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"homepage     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"https://www.deliveryhero.com\"'),`\n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"author       \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Package Author\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\">\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"someone@deliveryhero.com\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"platform     \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token symbol\"}),\":ios\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"11\"'),`\n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"source       \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"{\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token symbol\"}),\":git\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\">\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"git@github.com:deliveryhero/MyChatModule.git\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token symbol\"}),\":tag\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\">\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"',mdx(\"span\",e({parentName:\"span\"},{className:\"token interpolation\"}),mdx(\"span\",e({parentName:\"span\"},{className:\"token delimiter tag\"}),\"#{\"),\"s\",mdx(\"span\",e({parentName:\"span\"},{className:\"token punctuation\"}),\".\"),\"version\",mdx(\"span\",e({parentName:\"span\"},{className:\"token delimiter tag\"}),\"}\")),'\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"}\"),`\n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"swift_version \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'5.0'\"),`\n  \n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"static_framework \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token boolean\"}),\"true\"),`\n\n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"dependency \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'DependencyInjection'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'1.0.0'\"),`\n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"dependency \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'Networking'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'1.0.0'\"),`\n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"dependency \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'ExternalSDK'\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'5.2.1'\"),`\n  \n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"source_files \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Sources/**/*.{swift}\"'),`\n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"resources \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Resources/**/*.{storyboard,xib,xcassets,png,pdf,ttf}\"'),`\n\n  s`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"test_spec \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'UnitTests'\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"do\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"|\"),\"test_spec\",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"|\"),`\n    test_spec`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"source_files \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),\"'Tests/**/*.{swift}'\"),`\n  `,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"end\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"end\"),`\n`)),mdx(\"h5\",e({},{id:\"spm-package-manifest\"}),mdx(\"a\",e({parentName:\"h5\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#spm-package-manifest\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"SPM package manifest\"),mdx(\"pre\",e({},{className:\"language-swift\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-swift\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// swift-tools-version:5.3\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin\"}),\"PackageDescription\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"let\"),\" package \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"Package\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n    name`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"MyChatModule\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n    platforms`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"iOS\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"v11\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n    products`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"library\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n            name`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"MyChatModule\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n            targets`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"MyChatModule\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n    dependencies`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"package\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"path\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"../DependencyInjection\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"package\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"path\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"../Networking\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"package\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"url\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"https://github.com/ExternalSDKCompany/ExternalSDK-iOS.git\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" from\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"5.2.1\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n    targets`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"target\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n            name`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"MyChatModule\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n            dependencies`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Networking\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),` \n                           `,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"DependencyInjection\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),` \n                           `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"product\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"name\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"ExternalSDK\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" package\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"ExternalSDK-ios\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n            path`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Sources\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n            resources`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"process\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Resources/Assets.xcassets\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n                        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"process\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Resources/Illustrations.xcassets\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),` \n                        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"process\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Resources/Icons.xcassets\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),` \n                        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"copy\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Resources/Fonts/font.ttf\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"testTarget\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n            name`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"MyChatModule-UnitTests\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n            dependencies`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"MyChatModule\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n            path`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Tests\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`)),mdx(\"h2\",e({},{id:\"wishlist\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#wishlist\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Wishlist\"),mdx(\"p\",null,\"I am going to take you through what else I would like to see in the SPM.\"),mdx(\"h3\",e({},{id:\"shallow-clones-of-the-dependencies\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#shallow-clones-of-the-dependencies\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Shallow clones of the dependencies\"),mdx(\"p\",null,\"Truly low-hanging fruit that would speed up the CI. This is currently not possible, because SPM needs to know the version history of a package. This must not be an issue, if you would be using \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://swiftpackageregistry.com\"}),\"Swift Package Registry\")),mdx(\"h3\",e({},{id:\"build-artifacts-caching\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#build-artifacts-caching\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Build artifacts caching\"),mdx(\"p\",null,\"Wouldn't it be great to not have to rebuild changes every time on your computer or the CI?\"),mdx(\"p\",null,\"There are multiple ways to achieve this. The easiest way would be to add an option for SPM to store the artifacts in a certain folder on the file system and try to read them from there. Certainly, it is much more complex than that, but at least for a given dependency version and a given Xcode version, it should be entirely possible to cache all the build products.\"),mdx(\"p\",null,\"In hermetic build systems like Bazel, it is possible to collect all the arguments the build step needs and avoid other side effects. Using this feature, it is possible to cache the build artifacts for the given input and reuse them in case the inputs (source files, configurations, libraries) were not changed.\"),mdx(\"p\",null,\"I believe work on this topic is already happening inside of the SPM team, so we would be able to benefit from it in the future.\"),mdx(\"h3\",e({},{id:\"solution-we-ended-up-with\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#solution-we-ended-up-with\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Solution we ended up with\"),mdx(\"p\",null,\"In my team we ended up using a local copy of foreign dependencies \",mdx(\"inlineCode\",{parentName:\"p\"},\"xcframeworks\"),\" gathered under a single \",mdx(\"inlineCode\",{parentName:\"p\"},\"Package.swift\"),\" manifest. Such a copy can be created using Carthage. This allows to speed up build times and removed the warnings displayed from them.\"),mdx(\"h2\",e({},{id:\"nota-bene-spm-slack\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#nota-bene-spm-slack\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Nota Bene: SPM Slack\"),mdx(\"p\",null,\"If you have ideas about SPM or would like to participate in a discussion on the topic, you can register for \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://swift-package-manager.herokuapp.com\"}),\"SPM Unofficial Slack\"),\". Some of the \",mdx(\"em\",{parentName:\"p\"},\"best\"),\" Apple engineers are also present there.\"))}MDXContent.isMDXComponent=!0;\n","scope":{"title":"Moving a large project from Cocoapods to Swift Package Manager","description":"What should you know before moving a large project to Swift Package Manager (SPM) from Cocoapods or other dependancy management system for iOS development.","date":"2022-08-31","image":"/images/spm/packages.jpg","published":true}},"frontMatter":{"title":"Moving a large project from Cocoapods to Swift Package Manager","description":"What should you know before moving a large project to Swift Package Manager (SPM) from Cocoapods or other dependancy management system for iOS development.","date":"2022-08-31","image":"/images/spm/packages.jpg","published":true}},"__N_SSG":true}