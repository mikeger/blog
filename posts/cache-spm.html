<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><script>!function(){try{var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem("theme");if(e){d.add(e)}else{d.add('dark');}}catch(t){}}();</script><title>Why do the same thing over and over? Part 1: External dependencies, Swift Package Manager - Mike Gerasymenko</title><meta content="Why recompile what you already compiled?" name="description"/><meta property="og:url" content="https://nextjs-typescript-mdx-blog.vercel.app/posts/cache-spm"/><link rel="canonical" href="https://nextjs-typescript-mdx-blog.vercel.app/posts/cache-spm"/><meta property="og:type" content="article"/><meta property="og:site_name" content="Mike Gerasymenko - iOS et al."/><meta property="og:description" content="Why recompile what you already compiled?"/><meta property="og:title" content="Why do the same thing over and over? Part 1: External dependencies, Swift Package Manager - Mike Gerasymenko"/><meta property="og:image" content="https://nextjs-typescript-mdx-blog.vercel.app/images/cache-spm/cover.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@huntarosan"/><meta name="twitter:title" content="Why do the same thing over and over? Part 1: External dependencies, Swift Package Manager - Mike Gerasymenko"/><meta name="twitter:description" content="Why recompile what you already compiled?"/><meta name="twitter:image" content="https://nextjs-typescript-mdx-blog.vercel.app/images/cache-spm/cover.jpg"/><meta property="article:published_time" content="2023-01-05"/><link rel="preload" as="image" imagesrcset="/images/cache-spm/cover.jpg?auto=format&amp;fit=max&amp;w=384 1x, /images/cache-spm/cover.jpg?auto=format&amp;fit=max&amp;w=640 2x"/><meta name="next-head-count" content="19"/><link rel="preload" href="/_next/static/css/3c344473ae44fdd81992.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3c344473ae44fdd81992.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-61095c13c5984b221292.js" defer=""></script><script src="/_next/static/chunks/framework-92300432a1172ef1338b.js" defer=""></script><script src="/_next/static/chunks/main-696b585dd874563fe98f.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ee6fc650a19b3cc42291.js" defer=""></script><script src="/_next/static/chunks/466-0c3cbe99aa1f071cd23c.js" defer=""></script><script src="/_next/static/chunks/522-2597210efd9529a81949.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-5f95380ee98e6c7e8b61.js" defer=""></script><script src="/_next/static/93L-bxnW7yBmw51YT8t2y/_buildManifest.js" defer=""></script><script src="/_next/static/93L-bxnW7yBmw51YT8t2y/_ssgManifest.js" defer=""></script></head><body class="bg-white dark:bg-black text-gray-900 dark:text-white"><div id="__next"><header><div class="max-w-5xl px-8 mx-auto"><div class="flex items-center justify-between py-6"><nav><a class="text-gray-900 dark:text-white pr-6 py-4" href="/">Home</a><a class="text-gray-900 dark:text-white px-6 py-4" href="/about">About</a></nav></div></div></header><main><div class="max-w-5xl px-8 py-4 mx-auto"><article><h1 class="mb-3 text-gray-900 dark:text-white">Why do the same thing over and over? Part 1: External dependencies, Swift Package Manager</h1><p class="mb-10 text-sm text-gray-500 dark:text-gray-400">January 05, 2023</p><div class="prose dark:prose-dark"><div style="overflow:hidden;box-sizing:border-box;display:inline-block;position:relative;width:320px;height:480px"><img alt="Pre-canned food" srcSet="/images/cache-spm/cover.jpg?auto=format&amp;fit=max&amp;w=384 1x, /images/cache-spm/cover.jpg?auto=format&amp;fit=max&amp;w=640 2x" src="/images/cache-spm/cover.jpg?auto=format&amp;fit=max&amp;w=640" decoding="async" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/></div><p>Presentaiton version available <a href="https://gera.cx/cache_spm.pdf">here</a>.</p><p>Video version available <a href="https://www.youtube.com/watch?v=IYAy-qMcVSI">here</a>.</p><p>If you are a Mobile Engineer like me, you’re likely extremely excited about Apple Silicon computers. They are performant and energy-efficient, but above all, they allow you to build your projects faster and without jet engine fan sounds. However, even with this improvement, the compilation times are very far from what you are getting in web development. Building locally, or on the CI, takes up momentum and can occasionally push you out of the flow, decreasing overall productivity.</p><p>Luckily, there are a couple of improvements for build time.</p><h2 id="why-build-the-same-things-over-and-over-again"><a aria-hidden="true" tabindex="-1" href="#why-build-the-same-things-over-and-over-again"><span class="icon icon-link"></span></a>Why build the same things over and over again?</h2><blockquote><p>“Insanity is doing the same thing over and over and expecting different results.”
Albert Einstein</p></blockquote><p>If you process the same input, using the fixed process and configuration, you can usually expect the same output. This optimization idea is used in many places. The most basic would be caching: save the web page generated in the cache, to serve it again if requested a second time. This idea lays the foundation for something called hermetic build systems, like <a href="https://bazel.build/basics/hermeticity">Bazel</a>. So when building the same source files with the same compiler, we should get the same binaries.</p><p>I am not <del>crazy</del>brave enough to move from the vendor build system. Let&#x27;s see what is possible to achieve in the world of <strong>Swift Package Manager</strong> with the existing tools.</p><p>Looking at the build logs and build timeline available in Xcode 14, I see that from the 10 minutes it takes to compile my project, around half of the time is spent building external dependencies. Taking into account that I don&#x27;t change the versions of those dependencies that frequently, wouldn&#x27;t it be great not to recompile them? One thing that is especially annoying here for me personally, is that Firebase rebuilds the protobuf library every time. Wait, I am sure I&#x27;ve seen this before. Where was it?</p><h3 id="reinventing-carthage"><a aria-hidden="true" tabindex="-1" href="#reinventing-carthage"><span class="icon icon-link"></span></a>Reinventing Carthage</h3><p>Now I remember clearly. <a href="https://github.com/Carthage/Carthage">Carthage</a> allows this! Carthage is another package management tool that was created before SwiftPM. Carthage is building external dependencies and packaging them as binary XCFrameworks. Why not use it?</p><h3 id="high-level-overview"><a aria-hidden="true" tabindex="-1" href="#high-level-overview"><span class="icon icon-link"></span></a>High-level overview</h3><p>We&#x27;ll move from using external dependencies compiled by SPM at build time, to using pre-compiled versions of the same dependencies:</p><ol><li>Define external dependencies in the Cartfile</li><li>Build external dependencies to XCFramework</li><li>Package all dependencies in your repo using git-lfs</li><li>Add logic to unpack the dependencies if required</li></ol><h3 id="lets-get-building"><a aria-hidden="true" tabindex="-1" href="#lets-get-building"><span class="icon icon-link"></span></a>Let&#x27;s get building</h3><p>The first step would be to define the <code>Cartfile</code>, which is just a Carthage way of defining the list of dependencies.</p><p>You can see the list of the packages your project relies on in the Project preferences pane, inside Xcode.</p><p>You would end up with something like this in your <code>Cartfile</code>:</p><pre class="language-bash"><code class="language-bash">github <span class="token string">&quot;https://github.com/Alamofire/Alamofire.git&quot;</span> <span class="token operator">==</span> <span class="token number">5.4</span>.1
github <span class="token string">&quot;https://github.com/SwiftyJSON/SwiftyJSON.git&quot;</span> <span class="token operator">==</span> <span class="token number">5.0</span>.0
github <span class="token string">&quot;https://github.com/vadymmarkov/Fakery&quot;</span> <span class="token operator">==</span> <span class="token number">5.0</span>.0
github <span class="token string">&quot;https://github.com/SDWebImage/SDWebImage.git&quot;</span> <span class="token operator">==</span> <span class="token number">5.8</span>.2
</code></pre><p>But wait, would this mean we will be using two different package managers?</p><p>Yes, but wait to see the full picture, we will only need to use Carthage when we would need to change the libraries&#x27; versions.</p><h4 id="install-and-run-carthage"><a aria-hidden="true" tabindex="-1" href="#install-and-run-carthage"><span class="icon icon-link"></span></a>Install and run Carthage</h4><p>Carthage can be installed from Homebrew, using <code>brew install carthage</code>.</p><p>Then you&#x27;ll need to run <code>carthage bootstrap --use-xcframeworks --platform &lt;Your platform, for exmaple iOS&gt;</code>. Carthage would then fetch your dependencies defined in <code>Cartfile</code> and sub-dependencies. Then it would find binaries for them (if provided) or would compile them from sources. In the end, you would get all of them compiled into <code>XCFramework</code> format.</p><h4 id="expose-the-frameworks-to-swift-package-manager"><a aria-hidden="true" tabindex="-1" href="#expose-the-frameworks-to-swift-package-manager"><span class="icon icon-link"></span></a>Expose the frameworks to Swift Package Manager</h4><p><code>XCFramework</code> is nice, but if you are using Swift Package Manager for local modules, you would need to carry out one additional step: create a package that will expose those dependencies. This is necessary, since you cannot declare a dependency on a bare framework in your file system: it has to be declared as a Swift Package Manager package.</p><p>This can be achieved by defining one <code>Package.swift</code> for all of the XCFrameworks:</p><pre class="language-swift"><code class="language-swift"><span class="token comment">// swift-tools-version:5.3</span>
<span class="token keyword">import</span> <span class="token builtin">PackageDescription</span>

<span class="token keyword">let</span> package <span class="token operator">=</span> <span class="token function">Package</span><span class="token punctuation">(</span>
    name<span class="token punctuation">:</span> <span class="token string">&quot;Contrib&quot;</span><span class="token punctuation">,</span>
    platforms<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">.</span><span class="token function">iOS</span><span class="token punctuation">(</span><span class="token punctuation">.</span>v11<span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    products<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">.</span><span class="token function">library</span><span class="token punctuation">(</span>
            name<span class="token punctuation">:</span> <span class="token string">&quot;Alamofire&quot;</span><span class="token punctuation">,</span>
            targets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;Alamofire&quot;</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    targets<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">.</span><span class="token function">binaryTarget</span><span class="token punctuation">(</span>
            name<span class="token punctuation">:</span> <span class="token string">&quot;Alamofire&quot;</span><span class="token punctuation">,</span>
            path<span class="token punctuation">:</span> <span class="token string">&quot;Alamofire.framework&quot;</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">)</span>
</code></pre><p>In the end, we&#x27;ll have following file structure:</p><pre class="language-bash"><code class="language-bash">Root
├── Cartfile
├── Carthage
│   └── Build
│       ├── Alamofire.xcframework
│       ├── Fakery.xcframework
│       ├── Package.swift
│       ├── SDWebImage.xcframework
│       └── SwiftyJSON.xcframework
├── MyProject.xcodeproj
├── Sources
└── setup.sh
</code></pre><h4 id="package-and-store-the-binary-frameworks"><a aria-hidden="true" tabindex="-1" href="#package-and-store-the-binary-frameworks"><span class="icon icon-link"></span></a>Package and store the binary frameworks</h4><p>Carthage is going to put the frameworks to <code>Carthage/Build</code>. This is where we can take them and archive them. As an example, you can use the <a href="https://support.apple.com/en-gb/guide/terminal/apdc52250ee-4659-4751-9a3a-8b7988150530/mac">tar</a> command:</p><pre class="language-bash"><code class="language-bash"><span class="token function">tar</span> cvzf Contrib.tar.gz Carthage/Build
</code></pre><h4 id="git-lfs"><a aria-hidden="true" tabindex="-1" href="#git-lfs"><span class="icon icon-link"></span></a>Git LFS</h4><p><a href="https://git-lfs.com">Git LFS</a> is a Git extension intended to make it easier to keep large-ish files in Git. Certainly, it&#x27;s possible to just add such files to Git normally, but it is not the best idea, as it would make your repo bigger and bigger the more versions of a given file you add.</p><p>Installing and using Git LFS is extremely easy:</p><pre class="language-bash"><code class="language-bash">brew <span class="token function">install</span> git-lfs
<span class="token function">git</span> lfs <span class="token function">install</span>
</code></pre><p>Then, let&#x27;s add our archive to Git LFS:</p><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> lfs track Contrib.tar.gz
<span class="token function">git</span> <span class="token function">add</span> .gitattributes
</code></pre><h4 id="prepare-the-frameworks-for-use"><a aria-hidden="true" tabindex="-1" href="#prepare-the-frameworks-for-use"><span class="icon icon-link"></span></a>Prepare the frameworks for use</h4><p>We need to think of other engineers who would be interacting with the repository. It&#x27;s a good idea to create a setup script that would make sure the Git LFS extension is installed and would pull the dependencies file. I will use tar as an example here again:</p><pre class="language-bash"><code class="language-bash">brew <span class="token function">install</span> git-lfs
<span class="token function">git</span> lfs <span class="token function">install</span>
<span class="token function">git</span> lfs pull
<span class="token function">tar</span> -xvf Contrib.tar.gz
</code></pre><h4 id="referring-from-swift-package-manager"><a aria-hidden="true" tabindex="-1" href="#referring-from-swift-package-manager"><span class="icon icon-link"></span></a>Referring from Swift Package Manager</h4><p>Since we have <code>Package.swift</code> now, we can refer from local Swift packages or Xcode projects to our binary frameworks. In your local package, it would look like this:</p><pre class="language-swift"><code class="language-swift"><span class="token comment">// swift-tools-version:5.3</span>
<span class="token keyword">import</span> <span class="token builtin">PackageDescription</span>

<span class="token keyword">let</span> package <span class="token operator">=</span> <span class="token function">Package</span><span class="token punctuation">(</span>
    name<span class="token punctuation">:</span> <span class="token string">&quot;CommonUI&quot;</span><span class="token punctuation">,</span>
    platforms<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">.</span><span class="token function">iOS</span><span class="token punctuation">(</span><span class="token punctuation">.</span>v11<span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    products<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    dependencies<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">.</span><span class="token function">package</span><span class="token punctuation">(</span>path<span class="token punctuation">:</span> <span class="token string">&quot;../../Contrib&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    targets<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">.</span><span class="token function">target</span><span class="token punctuation">(</span>
            name<span class="token punctuation">:</span> <span class="token string">&quot;CommonUI&quot;</span><span class="token punctuation">,</span>
            dependencies<span class="token punctuation">:</span> <span class="token punctuation">[</span>
              <span class="token punctuation">.</span><span class="token function">product</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">&quot;SDWebImage&quot;</span><span class="token punctuation">,</span> package<span class="token punctuation">:</span> <span class="token string">&quot;Contrib&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            path<span class="token punctuation">:</span> <span class="token string">&quot;Sources&quot;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">)</span>
</code></pre><h3 id="bottomline"><a aria-hidden="true" tabindex="-1" href="#bottomline"><span class="icon icon-link"></span></a>Bottomline</h3><p>As a result of this exercise, our team decreased the CI build and test time from 11 to 6 minutes. This has a significant effect on multiple verticals:</p><ul><li>A much faster feedback loop on the pull requests</li><li>Saving money on the CI credit</li><li>Less CO<sub>2</sub>, since we need to spin the CPU less</li><li>Since it is faster to build the project locally, there is less chance for an engineer to lose focus</li><li>Satisfaction from not rebuilding Firebase over and over: priceless</li></ul><h2 id="qa"><a aria-hidden="true" tabindex="-1" href="#qa"><span class="icon icon-link"></span></a>Q&amp;A</h2><h4 id="qq-should-one-consider-switching-to-carthage-altogether"><a aria-hidden="true" tabindex="-1" href="#qq-should-one-consider-switching-to-carthage-altogether"><span class="icon icon-link"></span></a>QQ: Should one consider switching to Carthage altogether?</h4><p>In my opinion no, because Swift PM allows for modularization.</p><h4 id="qq-why-use-xcframework-format-specifically"><a aria-hidden="true" tabindex="-1" href="#qq-why-use-xcframework-format-specifically"><span class="icon icon-link"></span></a>QQ: Why use XCFramework format, specifically?</h4><p>This format, in comparison to a regular <code>framework</code>, allows the packaging of several binaries of the same SDK for different architectures. In practice, this means Apple Silicon simulator support.</p><h4 id="qq-any-additional-effect-from-this"><a aria-hidden="true" tabindex="-1" href="#qq-any-additional-effect-from-this"><span class="icon icon-link"></span></a>QQ: Any additional effect from this?</h4><p>One of the effects of this optimization is that the dependencies are now dynamic frameworks. This has pros and cons:</p><ul><li><p>If you have multiple targets, every target would be able to link to the frameworks without growing in size. Static frameworks would be included in every target multiplying the size.</p></li><li><p>Dynamic frameworks negatively affect your app&#x27;s startup time. iOS takes some time to load dynamic libraries on the app startup.</p></li></ul></div></article></div></main><footer class="py-8"><div class="max-w-5xl px-8 mx-auto">Created by <a href="https://github.com/mikeger">Mike Gerasymenko</a> ©<!-- --> <!-- -->2023<!-- --> All rights reserved.</div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":{"compiledSource":"var l=Object.defineProperty,d=Object.defineProperties;var u=Object.getOwnPropertyDescriptors;var o=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;var r=(a,n,t)=\u003en in a?l(a,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[n]=t,e=(a,n)=\u003e{for(var t in n||(n={}))p.call(n,t)\u0026\u0026r(a,t,n[t]);if(o)for(var t of o(n))i.call(n,t)\u0026\u0026r(a,t,n[t]);return a},c=(a,n)=\u003ed(a,u(n));var m=(a,n)=\u003e{var t={};for(var s in a)p.call(a,s)\u0026\u0026n.indexOf(s)\u003c0\u0026\u0026(t[s]=a[s]);if(a!=null\u0026\u0026o)for(var s of o(a))n.indexOf(s)\u003c0\u0026\u0026i.call(a,s)\u0026\u0026(t[s]=a[s]);return t};const makeShortcode=a=\u003efunction(t){return console.warn(\"Component \"+a+\" was not imported, exported, or provided by MDXProvider as global scope\"),mdx(\"div\",e({},t))},Image=makeShortcode(\"Image\"),layoutProps={},MDXLayout=\"wrapper\";function MDXContent(t){var s=t,{components:a}=s,n=m(s,[\"components\"]);return mdx(MDXLayout,c(e(e({},layoutProps),n),{components:a,mdxType:\"MDXLayout\"}),mdx(Image,{alt:\"Pre-canned food\",src:\"/images/cache-spm/cover.jpg\",width:320,height:480,layout:\"fixed\",priority:!0,mdxType:\"Image\"}),mdx(\"p\",null,\"Presentaiton version available \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://gera.cx/cache_spm.pdf\"}),\"here\"),\".\"),mdx(\"p\",null,\"Video version available \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://www.youtube.com/watch?v=IYAy-qMcVSI\"}),\"here\"),\".\"),mdx(\"p\",null,\"If you are a Mobile Engineer like me, you\\u2019re likely extremely excited about Apple Silicon computers. They are performant and energy-efficient, but above all, they allow you to build your projects faster and without jet engine fan sounds. However, even with this improvement, the compilation times are very far from what you are getting in web development. Building locally, or on the CI, takes up momentum and can occasionally push you out of the flow, decreasing overall productivity.\"),mdx(\"p\",null,\"Luckily, there are a couple of improvements for build time.\"),mdx(\"h2\",e({},{id:\"why-build-the-same-things-over-and-over-again\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#why-build-the-same-things-over-and-over-again\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Why build the same things over and over again?\"),mdx(\"blockquote\",null,mdx(\"p\",{parentName:\"blockquote\"},`\\u201CInsanity is doing the same thing over and over and expecting different results.\\u201D\nAlbert Einstein`)),mdx(\"p\",null,\"If you process the same input, using the fixed process and configuration, you can usually expect the same output. This optimization idea is used in many places. The most basic would be caching: save the web page generated in the cache, to serve it again if requested a second time. This idea lays the foundation for something called hermetic build systems, like \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://bazel.build/basics/hermeticity\"}),\"Bazel\"),\". So when building the same source files with the same compiler, we should get the same binaries.\"),mdx(\"p\",null,\"I am not \",mdx(\"del\",{parentName:\"p\"},\"crazy\"),\"brave enough to move from the vendor build system. Let's see what is possible to achieve in the world of \",mdx(\"strong\",{parentName:\"p\"},\"Swift Package Manager\"),\" with the existing tools.\"),mdx(\"p\",null,\"Looking at the build logs and build timeline available in Xcode 14, I see that from the 10 minutes it takes to compile my project, around half of the time is spent building external dependencies. Taking into account that I don't change the versions of those dependencies that frequently, wouldn't it be great not to recompile them? One thing that is especially annoying here for me personally, is that Firebase rebuilds the protobuf library every time. Wait, I am sure I've seen this before. Where was it?\"),mdx(\"h3\",e({},{id:\"reinventing-carthage\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#reinventing-carthage\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Reinventing Carthage\"),mdx(\"p\",null,\"Now I remember clearly. \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://github.com/Carthage/Carthage\"}),\"Carthage\"),\" allows this! Carthage is another package management tool that was created before SwiftPM. Carthage is building external dependencies and packaging them as binary XCFrameworks. Why not use it?\"),mdx(\"h3\",e({},{id:\"high-level-overview\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#high-level-overview\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"High-level overview\"),mdx(\"p\",null,\"We'll move from using external dependencies compiled by SPM at build time, to using pre-compiled versions of the same dependencies:\"),mdx(\"ol\",null,mdx(\"li\",{parentName:\"ol\"},\"Define external dependencies in the Cartfile\"),mdx(\"li\",{parentName:\"ol\"},\"Build external dependencies to XCFramework\"),mdx(\"li\",{parentName:\"ol\"},\"Package all dependencies in your repo using git-lfs\"),mdx(\"li\",{parentName:\"ol\"},\"Add logic to unpack the dependencies if required\")),mdx(\"h3\",e({},{id:\"lets-get-building\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#lets-get-building\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Let's get building\"),mdx(\"p\",null,\"The first step would be to define the \",mdx(\"inlineCode\",{parentName:\"p\"},\"Cartfile\"),\", which is just a Carthage way of defining the list of dependencies.\"),mdx(\"p\",null,\"You can see the list of the packages your project relies on in the Project preferences pane, inside Xcode.\"),mdx(\"p\",null,\"You would end up with something like this in your \",mdx(\"inlineCode\",{parentName:\"p\"},\"Cartfile\"),\":\"),mdx(\"pre\",e({},{className:\"language-bash\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-bash\"}),\"github \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"https://github.com/Alamofire/Alamofire.git\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"==\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"5.4\"),`.1\ngithub `,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"https://github.com/SwiftyJSON/SwiftyJSON.git\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"==\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"5.0\"),`.0\ngithub `,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"https://github.com/vadymmarkov/Fakery\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"==\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"5.0\"),`.0\ngithub `,mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"https://github.com/SDWebImage/SDWebImage.git\"'),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"==\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token number\"}),\"5.8\"),`.2\n`)),mdx(\"p\",null,\"But wait, would this mean we will be using two different package managers?\"),mdx(\"p\",null,\"Yes, but wait to see the full picture, we will only need to use Carthage when we would need to change the libraries' versions.\"),mdx(\"h4\",e({},{id:\"install-and-run-carthage\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#install-and-run-carthage\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Install and run Carthage\"),mdx(\"p\",null,\"Carthage can be installed from Homebrew, using \",mdx(\"inlineCode\",{parentName:\"p\"},\"brew install carthage\"),\".\"),mdx(\"p\",null,\"Then you'll need to run \",mdx(\"inlineCode\",{parentName:\"p\"},\"carthage bootstrap --use-xcframeworks --platform \u003cYour platform, for exmaple iOS\u003e\"),\". Carthage would then fetch your dependencies defined in \",mdx(\"inlineCode\",{parentName:\"p\"},\"Cartfile\"),\" and sub-dependencies. Then it would find binaries for them (if provided) or would compile them from sources. In the end, you would get all of them compiled into \",mdx(\"inlineCode\",{parentName:\"p\"},\"XCFramework\"),\" format.\"),mdx(\"h4\",e({},{id:\"expose-the-frameworks-to-swift-package-manager\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#expose-the-frameworks-to-swift-package-manager\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Expose the frameworks to Swift Package Manager\"),mdx(\"p\",null,mdx(\"inlineCode\",{parentName:\"p\"},\"XCFramework\"),\" is nice, but if you are using Swift Package Manager for local modules, you would need to carry out one additional step: create a package that will expose those dependencies. This is necessary, since you cannot declare a dependency on a bare framework in your file system: it has to be declared as a Swift Package Manager package.\"),mdx(\"p\",null,\"This can be achieved by defining one \",mdx(\"inlineCode\",{parentName:\"p\"},\"Package.swift\"),\" for all of the XCFrameworks:\"),mdx(\"pre\",e({},{className:\"language-swift\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-swift\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// swift-tools-version:5.3\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin\"}),\"PackageDescription\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"let\"),\" package \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"Package\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n    name`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Contrib\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n    platforms`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"iOS\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"v11\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n    products`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"library\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n            name`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Alamofire\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n            targets`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Alamofire\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n    targets`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"binaryTarget\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n            name`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Alamofire\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n            path`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Alamofire.framework\"'),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`)),mdx(\"p\",null,\"In the end, we'll have following file structure:\"),mdx(\"pre\",e({},{className:\"language-bash\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-bash\"}),`Root\n\\u251C\\u2500\\u2500 Cartfile\n\\u251C\\u2500\\u2500 Carthage\n\\u2502\\xA0\\xA0 \\u2514\\u2500\\u2500 Build\n\\u2502\\xA0\\xA0     \\u251C\\u2500\\u2500 Alamofire.xcframework\n\\u2502\\xA0\\xA0     \\u251C\\u2500\\u2500 Fakery.xcframework\n\\u2502\\xA0\\xA0     \\u251C\\u2500\\u2500 Package.swift\n\\u2502\\xA0\\xA0     \\u251C\\u2500\\u2500 SDWebImage.xcframework\n\\u2502\\xA0\\xA0     \\u2514\\u2500\\u2500 SwiftyJSON.xcframework\n\\u251C\\u2500\\u2500 MyProject.xcodeproj\n\\u251C\\u2500\\u2500 Sources\n\\u2514\\u2500\\u2500 setup.sh\n`)),mdx(\"h4\",e({},{id:\"package-and-store-the-binary-frameworks\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#package-and-store-the-binary-frameworks\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Package and store the binary frameworks\"),mdx(\"p\",null,\"Carthage is going to put the frameworks to \",mdx(\"inlineCode\",{parentName:\"p\"},\"Carthage/Build\"),\". This is where we can take them and archive them. As an example, you can use the \",mdx(\"a\",e({parentName:\"p\"},{href:\"https://support.apple.com/en-gb/guide/terminal/apdc52250ee-4659-4751-9a3a-8b7988150530/mac\"}),\"tar\"),\" command:\"),mdx(\"pre\",e({},{className:\"language-bash\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-bash\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"tar\"),` cvzf Contrib.tar.gz Carthage/Build\n`)),mdx(\"h4\",e({},{id:\"git-lfs\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#git-lfs\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Git LFS\"),mdx(\"p\",null,mdx(\"a\",e({parentName:\"p\"},{href:\"https://git-lfs.com\"}),\"Git LFS\"),\" is a Git extension intended to make it easier to keep large-ish files in Git. Certainly, it's possible to just add such files to Git normally, but it is not the best idea, as it would make your repo bigger and bigger the more versions of a given file you add.\"),mdx(\"p\",null,\"Installing and using Git LFS is extremely easy:\"),mdx(\"pre\",e({},{className:\"language-bash\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-bash\"}),\"brew \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"install\"),` git-lfs\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"git\"),\" lfs \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"install\"),`\n`)),mdx(\"p\",null,\"Then, let's add our archive to Git LFS:\"),mdx(\"pre\",e({},{className:\"language-bash\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-bash\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"git\"),` lfs track Contrib.tar.gz\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"git\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"add\"),` .gitattributes\n`)),mdx(\"h4\",e({},{id:\"prepare-the-frameworks-for-use\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#prepare-the-frameworks-for-use\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Prepare the frameworks for use\"),mdx(\"p\",null,\"We need to think of other engineers who would be interacting with the repository. It's a good idea to create a setup script that would make sure the Git LFS extension is installed and would pull the dependencies file. I will use tar as an example here again:\"),mdx(\"pre\",e({},{className:\"language-bash\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-bash\"}),\"brew \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"install\"),` git-lfs\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"git\"),\" lfs \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"install\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"git\"),` lfs pull\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"tar\"),` -xvf Contrib.tar.gz\n`)),mdx(\"h4\",e({},{id:\"referring-from-swift-package-manager\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#referring-from-swift-package-manager\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Referring from Swift Package Manager\"),mdx(\"p\",null,\"Since we have \",mdx(\"inlineCode\",{parentName:\"p\"},\"Package.swift\"),\" now, we can refer from local Swift packages or Xcode projects to our binary frameworks. In your local package, it would look like this:\"),mdx(\"pre\",e({},{className:\"language-swift\"}),mdx(\"code\",e({parentName:\"pre\"},{className:\"language-swift\"}),mdx(\"span\",e({parentName:\"code\"},{className:\"token comment\"}),\"// swift-tools-version:5.3\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"import\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token builtin\"}),\"PackageDescription\"),`\n\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token keyword\"}),\"let\"),\" package \",mdx(\"span\",e({parentName:\"code\"},{className:\"token operator\"}),\"=\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"Package\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n    name`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"CommonUI\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n    platforms`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"iOS\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),\"v11\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n    products`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n    dependencies`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"package\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"path\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"../../Contrib\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n    targets`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"target\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),`\n            name`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"CommonUI\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n            dependencies`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"[\"),`\n              `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\".\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token function\"}),\"product\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"(\"),\"name\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"SDWebImage\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),\" package\",mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Contrib\"'),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n            `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\",\"),`\n            path`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\":\"),\" \",mdx(\"span\",e({parentName:\"code\"},{className:\"token string\"}),'\"Sources\"'),`\n        `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n    `,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\"]\"),`\n`,mdx(\"span\",e({parentName:\"code\"},{className:\"token punctuation\"}),\")\"),`\n`)),mdx(\"h3\",e({},{id:\"bottomline\"}),mdx(\"a\",e({parentName:\"h3\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#bottomline\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Bottomline\"),mdx(\"p\",null,\"As a result of this exercise, our team decreased the CI build and test time from 11 to 6 minutes. This has a significant effect on multiple verticals:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},\"A much faster feedback loop on the pull requests\"),mdx(\"li\",{parentName:\"ul\"},\"Saving money on the CI credit\"),mdx(\"li\",{parentName:\"ul\"},\"Less CO\",mdx(\"sub\",null,\"2\"),\", since we need to spin the CPU less\"),mdx(\"li\",{parentName:\"ul\"},\"Since it is faster to build the project locally, there is less chance for an engineer to lose focus\"),mdx(\"li\",{parentName:\"ul\"},\"Satisfaction from not rebuilding Firebase over and over: priceless\")),mdx(\"h2\",e({},{id:\"qa\"}),mdx(\"a\",e({parentName:\"h2\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#qa\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"Q\u0026A\"),mdx(\"h4\",e({},{id:\"qq-should-one-consider-switching-to-carthage-altogether\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#qq-should-one-consider-switching-to-carthage-altogether\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"QQ: Should one consider switching to Carthage altogether?\"),mdx(\"p\",null,\"In my opinion no, because Swift PM allows for modularization.\"),mdx(\"h4\",e({},{id:\"qq-why-use-xcframework-format-specifically\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#qq-why-use-xcframework-format-specifically\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"QQ: Why use XCFramework format, specifically?\"),mdx(\"p\",null,\"This format, in comparison to a regular \",mdx(\"inlineCode\",{parentName:\"p\"},\"framework\"),\", allows the packaging of several binaries of the same SDK for different architectures. In practice, this means Apple Silicon simulator support.\"),mdx(\"h4\",e({},{id:\"qq-any-additional-effect-from-this\"}),mdx(\"a\",e({parentName:\"h4\"},{\"aria-hidden\":\"true\",tabIndex:-1,href:\"#qq-any-additional-effect-from-this\"}),mdx(\"span\",e({parentName:\"a\"},{className:\"icon icon-link\"}))),\"QQ: Any additional effect from this?\"),mdx(\"p\",null,\"One of the effects of this optimization is that the dependencies are now dynamic frameworks. This has pros and cons:\"),mdx(\"ul\",null,mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"If you have multiple targets, every target would be able to link to the frameworks without growing in size. Static frameworks would be included in every target multiplying the size.\")),mdx(\"li\",{parentName:\"ul\"},mdx(\"p\",{parentName:\"li\"},\"Dynamic frameworks negatively affect your app's startup time. iOS takes some time to load dynamic libraries on the app startup.\"))))}MDXContent.isMDXComponent=!0;\n","scope":{"title":"Why do the same thing over and over? Part 1: External dependencies, Swift Package Manager","description":"Why recompile what you already compiled?","date":"2023-01-05","image":"/images/cache-spm/cover.jpg","published":true}},"frontMatter":{"title":"Why do the same thing over and over? Part 1: External dependencies, Swift Package Manager","description":"Why recompile what you already compiled?","date":"2023-01-05","image":"/images/cache-spm/cover.jpg","published":true}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"cache-spm"},"buildId":"93L-bxnW7yBmw51YT8t2y","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>